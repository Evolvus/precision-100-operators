CONTAINER=$1
INDEX=$(echo $2 | cut -d ',' -f 1)
FILE_NAME=$(echo $2 | cut -d ',' -f 2)
FILE_TYPE=$(echo $2 | cut -d ',' -f 3)
SPOOL_FILE_NAME=$(echo $2 | cut -d ',' -f 7)

if test "$PRECISION100_RUNTIME_SIMULATION_MODE" = "TRUE"; then
   echo "        START T24-PARAMETER-XML-CSV ADAPTOR $FILE_NAME"
   sleep $PRECISION100_RUNTIME_SIMULATION_SLEEP;
   echo "        END T24-PARAMETER-XML-CSV ADAPTOR $FILE_NAME"
   exit;
fi

echo "        START T24-PARAMETER-XML-CSV ADAPTOR $FILE_NAME"

source $PRECISION100_OPERATORS_FOLDER/t24-parameter-xml-csv/conf/.operator.env.sh

SOURCE_FILE="$PRECISION100_EXECUTION_CONTAINER_FOLDER/$CONTAINER/$FILE_NAME"
SPOOL_FILE="$PRECISION100_OPERATOR_T24_PARAMETER_XML_CSV_OUTPUT_FOLDER/${SPOOL_FILE_NAME:-$FILE_NAME.csv}"

$PRECISION100_BIN_FOLDER/audit.sh  $0 "PRE-T24-PARAMETER-XML-CSV" "$CONTAINER / $FILE_NAME" "T24-PARAMETER-XML-CSV" $0 "START"

java -jar $PRECISION100_OPERATORS_FOLDER/t24-parameter-xml-csv/bin/t24-parameter-parser.jar $SOURCE_FILE > $SPOOL_FILE

$PRECISION100_BIN_FOLDER/audit.sh  $0 "POST-T24-PARAMETER-XML-CSV" "$CONTAINER / $FILE_NAME" "T24-PARAMETER-XML-CSV" $0 "END"

echo "        END T24-PARAMETER-XML-CSV ADAPTOR $FILE_NAME"
